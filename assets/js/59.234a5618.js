(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{483:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"问题描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题描述"}},[s._v("#")]),s._v(" 问题描述")]),s._v(" "),a("p",[a("code",[s._v("java.lang.NoClassDefFoundError")]),s._v(" ，意味着找不到类定义，当"),a("code",[s._v("JVM")]),s._v("或者"),a("code",[s._v("ClassLoader")]),s._v("实例尝试装载该类的定义（这通常是一个方法调用或者"),a("code",[s._v("new")]),s._v("表达式创建一个实例过程的一部分）而这个类定义并没有找时所抛出的错误。")]),s._v(" "),a("h1",{attrs:{id:"问题原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题原因"}},[s._v("#")]),s._v(" 问题原因")]),s._v(" "),a("p",[s._v("该异常一般出现在编译环境和运行环境不一致的情况下，就是说有可能在编译过后更改了"),a("code",[s._v("Classpath")]),s._v("或者"),a("code",[s._v("jar")]),s._v("包所以导致在运行的过程中"),a("code",[s._v("JVM")]),s._v("或者"),a("code",[s._v("ClassLoader")]),s._v("无法找到这个类的定义。")]),s._v(" "),a("p",[a("code",[s._v("NoClassDefFoundError")]),s._v("错误的发生，是因为"),a("code",[s._v("Java")]),s._v("虚拟机在编译时能找到合适的类，而在运行时不能找到合适的类导致的错误。例如在运行时我们想调用某个类的方法或者访问这个类的静态成员的时候，发现这个类不可用，此时"),a("code",[s._v("Java")]),s._v("虚拟机就会抛出"),a("code",[s._v("NoClassDefFoundError")]),s._v("错误。与"),a("code",[s._v("ClassNotFoundException")]),s._v("的不同在于，这个错误发生只在运行时需要加载对应的类不成功，而不是编译时发生。很多"),a("code",[s._v("Java")]),s._v("开发者很容易在这里把这两个错误搞混。")]),s._v(" "),a("h1",{attrs:{id:"noclassdeffounderror和classnotfoundexception区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#noclassdeffounderror和classnotfoundexception区别"}},[s._v("#")]),s._v(" NoClassDefFoundError和ClassNotFoundException区别")]),s._v(" "),a("p",[s._v("我们经常被"),a("code",[s._v("java.lang.ClassNotFoundException")]),s._v("和"),a("code",[s._v("java.lang.NoClassDefFoundError")]),s._v("这两个错误迷惑不清，尽管他们都与"),a("code",[s._v("Java classpath")]),s._v("有关，但是他们完全不同。"),a("code",[s._v("NoClassDefFoundError")]),s._v("发生在"),a("code",[s._v("JVM")]),s._v("在动态运行时，根据你提供的类名，在"),a("code",[s._v("classpath")]),s._v("中找到对应的类进行加载，但当它找不到这个类时，就发生了"),a("code",[s._v("java.lang.NoClassDefFoundError")]),s._v("的错误，而"),a("code",[s._v("ClassNotFoundException")]),s._v("是在编译的时候在"),a("code",[s._v("classpath")]),s._v("中找不到对应的类而发生的错误。"),a("code",[s._v("ClassNotFoundException")]),s._v("比"),a("code",[s._v("NoClassDefFoundError")]),s._v("容易解决，是因为在编译时我们就知道错误发生，并且完全是由于环境的问题导致。而如果你在"),a("code",[s._v("J2EE")]),s._v("的环境下工作，并且得到"),a("code",[s._v("NoClassDefFoundError")]),s._v("的异常，而且对应的错误的类是确实存在的，这说明这个类对于类加载器来说，可能是不可见的。")]),s._v(" "),a("h1",{attrs:{id:"怎么解决noclassdeffounderror错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#怎么解决noclassdeffounderror错误"}},[s._v("#")]),s._v(" 怎么解决NoClassDefFoundError错误")]),s._v(" "),a("p",[s._v("可能的原因如下：")]),s._v(" "),a("ol",[a("li",[s._v("对应的"),a("code",[s._v("Class")]),s._v("在"),a("code",[s._v("java")]),s._v("的"),a("code",[s._v("classpath")]),s._v("中不可用")]),s._v(" "),a("li",[s._v("你可能用"),a("code",[s._v("jar")]),s._v("命令运行你的程序，但类并没有在"),a("code",[s._v("jar")]),s._v("文件的"),a("code",[s._v("manifest")]),s._v("文件中的"),a("code",[s._v("classpath")]),s._v("属性中定义")]),s._v(" "),a("li",[s._v("可能程序的启动脚本覆盖了原来的"),a("code",[s._v("classpath")]),s._v("环境变量")]),s._v(" "),a("li",[s._v("因为"),a("code",[s._v("NoClassDefFoundError")]),s._v("是"),a("code",[s._v("java.lang.LinkageError")]),s._v("的一个子类，所以可能由于程序依赖的原生的类库不可用而导致")]),s._v(" "),a("li",[s._v("检查日志文件中是否有"),a("code",[s._v("java.lang.ExceptionInInitializerError")]),s._v("这样的错误，"),a("code",[s._v("NoClassDefFoundError")]),s._v("有可能是由于静态初始化失败导致的")]),s._v(" "),a("li",[s._v("如果你工作在"),a("code",[s._v("J2EE")]),s._v("的环境，有多个不同的类加载器，也可能导致"),a("code",[s._v("NoClassDefFoundError")])]),s._v(" "),a("li",[s._v("跨进程调用  导致找不到那个类")])]),s._v(" "),a("h1",{attrs:{id:"noclassdeffounderror解决示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#noclassdeffounderror解决示例"}},[s._v("#")]),s._v(" NoClassDefFoundError解决示例")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("当发生由于缺少"),a("code",[s._v("jar")]),s._v("文件，或者"),a("code",[s._v("jar")]),s._v("文件没有添加到"),a("code",[s._v("classpath")]),s._v("，或者"),a("code",[s._v("jar")]),s._v("的文件名发生变更会导致"),a("code",[s._v("java.lang.NoClassDefFoundError")]),s._v("的错误。")])]),s._v(" "),a("li",[a("p",[s._v("当类不在"),a("code",[s._v("classpath")]),s._v("中时，这种情况很难确切的知道，但如果在程序中打印出"),a("code",[s._v("System.getproperty(“java.classpath”)")]),s._v("，可以得到程序实际运行的"),a("code",[s._v("classpath")])])]),s._v(" "),a("li",[a("p",[s._v("运行时明确指定你认为程序能正常运行的 "),a("code",[s._v("-classpath")]),s._v(" 参数，如果增加之后程序能正常运行，说明原来程序的"),a("code",[s._v("classpath")]),s._v("被其他人覆盖了。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("NoClassDefFoundError")]),s._v("也可能由于类的静态初始化模块错误导致，当你的类执行一些静态初始化模块操作，如果初始化模块抛出异常，哪些依赖这个类的其他类会抛出"),a("code",[s._v("NoClassDefFoundError")]),s._v("的错误。如果你查看程序日志，会发现一些"),a("code",[s._v("java.lang.ExceptionInInitializerError")]),s._v("的错误日志，"),a("code",[s._v("ExceptionInInitializerError")]),s._v("的错误会导致"),a("code",[s._v("java.lang.NoClassDefFoundError: Could not initialize class")]),s._v("，如下面的代码示例：")])])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("/**\n * Java program to demonstrate how failure of static initialization subsequently cause\n * java.lang.NoClassDefFoundError in Java.\n * @author Javin Paul\n */")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NoClassDefFoundErrorDueToStaticInitFailure")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v(" users "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            users"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("valueOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//will throw NoClassDefFoundError")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("catch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Throwable")]),s._v(" t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("printStackTrace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("         \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("USER_ID")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getUserId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("USER_ID")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getUserId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("RuntimeException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"UserId Not found"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("     \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Output")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("ExceptionInInitializerError")]),s._v("\n    at "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("testing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("NoClassDefFoundErrorDueToStaticInitFailure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NoClassDefFoundErrorDueToStaticInitFailure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Caused")]),s._v(" by"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("RuntimeException")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UserId")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Not")]),s._v(" found\n    at "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("testing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getUserId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NoClassDefFoundErrorDueToStaticInitFailure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("testing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("clinit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NoClassDefFoundErrorDueToStaticInitFailure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" more\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("NoClassDefFoundError")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Could")]),s._v(" not initialize "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("testing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("User")]),s._v("\n    at "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("testing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("NoClassDefFoundErrorDueToStaticInitFailure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NoClassDefFoundErrorDueToStaticInitFailure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Read")]),s._v(" more"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("javarevisited"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("blogspot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2011")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("06")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("noclassdeffounderror"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("exception"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("in"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("html#ixzz3dqtbvHDy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("由于"),a("code",[s._v("NoClassDefFoundError")]),s._v("是"),a("code",[s._v("LinkageError")]),s._v("的子类，而"),a("code",[s._v("LinkageError")]),s._v("的错误在依赖其他的类时会发生，所以如果你的程序依赖原生的类库和需要的"),a("code",[s._v("dll")]),s._v("不存在时，有可能出现"),a("code",[s._v("java.lang.NoClassDefFoundError")]),s._v("。这种错误也可能抛出"),a("code",[s._v("java.lang.UnsatisfiedLinkError: no dll in java.library.path Exception Java")]),s._v("这样的异常。解决的办法是把依赖的类库和"),a("code",[s._v("dll")]),s._v("跟你的"),a("code",[s._v("jar")]),s._v("包放在一起。")])]),s._v(" "),a("li",[a("p",[s._v("如果你使用"),a("code",[s._v("Ant")]),s._v("构建脚本来生成"),a("code",[s._v("jar")]),s._v("文件和"),a("code",[s._v("manifest")]),s._v("文件，要确保"),a("code",[s._v("Ant")]),s._v("脚本获取的是正确的"),a("code",[s._v("classpath")]),s._v("值写入到"),a("code",[s._v("manifest.mf")]),s._v("文件")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("Jar")]),s._v("文件的权限问题也可能导致"),a("code",[s._v("NoClassDefFoundError")]),s._v("，如果你的程序运行在像"),a("code",[s._v("linux")]),s._v("这样多用户的操作系统种，你需要把你应用相关的资源文件，如"),a("code",[s._v("Jar")]),s._v("文件，类库文件，配置文件的权限单独分配给程序所属用户组，如果你使用了多个用户不同程序共享的"),a("code",[s._v("jar")]),s._v("包时，很容易出现权限问题。比如其他用户应用所属权限的"),a("code",[s._v("jar")]),s._v("包你的程序没有权限访问，会导致"),a("code",[s._v("java.lang.NoClassDefFoundError")]),s._v("的错误。")])]),s._v(" "),a("li",[a("p",[s._v("基于"),a("code",[s._v("XML")]),s._v("配置的程序也可能导致"),a("code",[s._v("NoClassDefFoundError")]),s._v("的错误。比如大多数"),a("code",[s._v("Java")]),s._v("的框架像"),a("code",[s._v("Spring")]),s._v("，"),a("code",[s._v("Struts")]),s._v("使用"),a("code",[s._v("xml")]),s._v("配置获取对应的"),a("code",[s._v("bean")]),s._v("信息，如果你输入了错误的名称，程序可能会加载其他错误的类而导致"),a("code",[s._v("NoClassDefFoundError")]),s._v("异常。我们在使用"),a("code",[s._v("Spring MVC")]),s._v("框架或者"),a("code",[s._v("Apache Struts")]),s._v("框架，在部署"),a("code",[s._v("War")]),s._v("文件或者"),a("code",[s._v("EAR")]),s._v("文件时就经常会出现"),a("code",[s._v("Exception in thread “main” java.lang.NoClassDefFoundError。")])])]),s._v(" "),a("li",[a("p",[s._v("在有多个"),a("code",[s._v("ClassLoader")]),s._v("的"),a("code",[s._v("J2EE")]),s._v("的环境中，很容易出现"),a("code",[s._v("NoClassDefFoundError")]),s._v("的错误。由于"),a("code",[s._v("J2EE")]),s._v("没有指明标准的类加载器，使用的类加载器依赖与不同的容器像"),a("code",[s._v("Tomcat")]),s._v("、"),a("code",[s._v("WebLogic")]),s._v("，"),a("code",[s._v("WebSphere")]),s._v("加载"),a("code",[s._v("J2EE")]),s._v("的不同组件如"),a("code",[s._v("War")]),s._v("包或者"),a("code",[s._v("EJB-JAR")]),s._v("包。关于类加载器的相关知识可以参考这篇文章类加载器的工作原理。")])]),s._v(" "),a("li",[a("p",[s._v("总结来说，类加载器基于三个机制：委托、可见性和单一性，委托机制是指将加载一个类的请求交给父类加载器，如果这个父类加载器不能够找到或者加载这个类，那么再加载它。可见性的原理是子类的加载器可以看见所有的父类加载器加载的类，而父类加载器看不到子类加载器加载的类。单一性原理是指仅加载一个类一次，这是由委托机制确保子类加载器不会再次加载父类加载器加载过的类。现在假设一个"),a("code",[s._v("User")]),s._v("类在"),a("code",[s._v("WAR")]),s._v("文件和"),a("code",[s._v("EJB-JAR")]),s._v("文件都存在，并且被"),a("code",[s._v("WAR ClassLoader")]),s._v("加载，而"),a("code",[s._v("WAR ClassLoader")]),s._v("是加载"),a("code",[s._v("EJB-JAR ClassLoader")]),s._v("的子"),a("code",[s._v("ClassLoader")]),s._v("。当"),a("code",[s._v("EJB-JAR")]),s._v("中代码引用这个"),a("code",[s._v("User")]),s._v("类时，加载"),a("code",[s._v("EJB-JAR")]),s._v("所有"),a("code",[s._v("class")]),s._v("的"),a("code",[s._v("Classloader")]),s._v("找不到这个类，因为这个类已经被"),a("code",[s._v("EJB-JAR classloader")]),s._v("的子加载器"),a("code",[s._v("WAR classloader")]),s._v("加载。")])]),s._v(" "),a("li",[a("p",[s._v("这会导致的结果就是对"),a("code",[s._v("User")]),s._v("类出现"),a("code",[s._v("NoClassDefFoundError")]),s._v("异常，而如果在两个"),a("code",[s._v("JAR")]),s._v("包中这个"),a("code",[s._v("User")]),s._v("类都存在，如果你使用"),a("code",[s._v("equals")]),s._v("方法比较两个类的对象时，会出现"),a("code",[s._v("ClassCastException")]),s._v("的异常，因为两个不同类加载器加载的类无法进行比较。")])]),s._v(" "),a("li",[a("p",[s._v("有时候会出现"),a("code",[s._v("Exception in thread “main” java.lang.NoClassDefFoundError: com/sun/tools/javac/Main")]),s._v(" 这样的错误，这个错误说明你的"),a("code",[s._v("Classpath")]),s._v(", "),a("code",[s._v("PATH")]),s._v(" 或者 "),a("code",[s._v("JAVA_HOME")]),s._v("没有安装配置正确或者"),a("code",[s._v("JDK")]),s._v("的安装不正确。这个问题的解决办法时重新安装你的"),a("code",[s._v("JDK")]),s._v("。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("Java")]),s._v("在执行"),a("code",[s._v("linking")]),s._v("操作的时候，也可能导致"),a("code",[s._v("NoClassDefFoundError")]),s._v("。例如在前面的脚本中，如果在编译完成之后，我们删除"),a("code",[s._v("User")]),s._v("的编译文件，再运行程序，这个时候你就会直接得到"),a("code",[s._v("NoClassDefFoundError")]),s._v("，而错误的消息只打印出"),a("code",[s._v("User")]),s._v("类的名称。")])])]),s._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("NoClassDefFoundError")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" testing"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("User")]),s._v("\n    at "),a("span",{pre:!0,attrs:{class:"token class-name"}},[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("testing"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),s._v("NoClassDefFoundErrorDueToStaticInitFailure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("NoClassDefFoundErrorDueToStaticInitFailure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("java"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h1",{attrs:{id:"实际情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实际情况"}},[s._v("#")]),s._v(" 实际情况")]),s._v(" "),a("p",[s._v("更新服务在停止旧服务之前没有休眠，而是立即启动了新服务。（测试休眠一会再启动新服务后不报错，所以猜测是这个原因。）")])])}),[],!1,null,null,null);a.default=e.exports}}]);